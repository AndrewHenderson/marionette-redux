{"version":3,"sources":["marionette-redux.min.js"],"names":["global","factory","exports","module","require","define","amd","MarionetteRedux","_","Marionette","this","underscore","backbone_marionette","mapStateToProps","mapDispatchToProps","dispatch","mergeProps","stateProps","dispatchProps","parentProps","extend","isDisplayComponent","Component","isFunction","prototype","View","Behavior","isObject","connect","_mapStateToProps","_mapDispatchToProps","_mergeProps","_options","options","mapStateToProps$$1","mapDispatchToProps$$1","mergeProps$$1","store","componentInitialize","initialize","componentonRender","onRender","componentOnDestroy","onDestroy","connectMixin","defaults","_initOptions","initOptions","mixin","call","props","apply","arguments","omit","mapState","mapDispatch","window","storeState","getState","state","getInitialState","bindStateEvents","clearCache","trySubscribe","setState","key","val","unset","silent","changes","changing","_changing","_previousState","clone","changed","current","prev","each","_val","_key","isEqual","push","length","_pending","i","trigger","attr","bind","bindEvents","bindEntityEvents","stateEvents","unbindStateEvents","unbind","unbindEvents","unbindEntityEvents","computeStateProps","finalMapStateToProps","configureFinalMapState","doStatePropsDependOnOwnProps","mappedState","isFactory","updateStatePropsIfNeeded","nextStateProps","computeDispatchProps","finalMapDispatchToProps","configureFinalMapDispatch","doDispatchPropsDependOnOwnProps","mappedDispatch","updateDispatchPropsIfNeeded","nextDispatchProps","isSubscribed","unsubscribe","subscribe","handleChange","handleDispatchProps","tryUnsubscribe","haveInitialStatePropsBeenDetermined","haveInitialDispatchPropsBeenDetermined","prevStoreState","haveStatePropsChanged","mergedProps","componentDidReceiveProps","version","VERSION"],"mappings":"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","file":"marionette-redux.min.js","sourcesContent":["// Marionette Redux\n// ----------------------------------\n// v0.1.7\n//\n// Copyright (c)2016 Andrew Henderson.\n// Distributed under MIT license\n!function(t,i){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=i(require(\"underscore\"),require(\"backbone.marionette\")):\"function\"==typeof define&&define.amd?define([\"underscore\",\"backbone.marionette\"],i):t.MarionetteRedux=i(t._,t.Marionette)}(this,function(t,i){\"use strict\";function e(){return{}}function s(t){return{dispatch:t}}function n(i,e,s){return t.extend({},s,i,e)}function r(e){return t.isObject(e)?e instanceof i.View||e instanceof i.Behavior:!!t.isFunction(e)&&(e.prototype instanceof i.View||e.prototype instanceof i.Behavior)}function o(i,o,p,h){var c=h||{};return function(h){var u=i||h.prototype.mapStateToProps||e,d=o||h.prototype.mapDispatchToProps||s,f=p||h.prototype.mergeProps||n,l=c.store||h.prototype.store,P=h.prototype.initialize,S=h.prototype.onRender,v=h.prototype.onDestroy,b=t.defaults({},{initialize:function(t){var i=t||{};a.initialize.call(this,{mapStateToProps:u,mapDispatchToProps:d,mergeProps:f,store:l,props:i.props}),P&&P.apply(this,arguments)},onRender:function(){a.onRender.apply(this,arguments),S&&S.apply(this,arguments)},onDestroy:function(){a.onDestroy.apply(this,arguments),v&&v.apply(this,arguments)}},a);return r(h)||(b=t.omit(b,\"onRender\")),h.extend(b)}}var a={initialize:function(i){var o=i||{};this.mapState=o.mapStateToProps||this.mapStateToProps||e,this.mapDispatch=o.mapDispatchToProps||this.mapDispatchToProps||s,this.mergeProps=o.mergeProps||this.mergeProps||n,this.props=this.props||{},o.props&&t.extend(this.props,o.props),this.store=o.store||this.store,!this.store&&window&&window.store&&(this.store=window.store);var a=this.store.getState();this.state=t.defaults({storeState:a},this.getInitialState()),this.bindStateEvents(),this.clearCache(),r(this)||this.trySubscribe()},getInitialState:function(){return{}},setState:function(i,e,s){if(null==i)return this;var n=void 0;t.isObject(i)?(n=i,s=e):(n={})[i]=e,s||(s={});var r=s.unset,o=s.silent,a=[],p=this._changing;this._changing=!0,p||(this._previousState=t.clone(this.state),this.changed={});var h=this.state,c=this.changed,u=this._previousState;if(t.each(n,function(i,e){t.isEqual(h[e],i)||a.push(e),t.isEqual(u[e],i)?delete c[e]:c[e]=i,r?delete h[e]:h[e]=i}),!o){a.length&&(this._pending=s);for(var d=0;d<a.length;d++)this.trigger(\"change:\"+a[d],this,h[a[d]],s)}if(p)return this;if(!o)for(;this._pending;)s=this._pending,this._pending=!1,this.trigger(\"change\",this,s);return this._pending=!1,this._changing=!1,this},getState:function(t){return this.state[t]},bindStateEvents:function(){var t=i.bindEvents||i.bindEntityEvents;this.stateEvents&&t(this,this,this.stateEvents)},unbindStateEvents:function(){var t=i.unbindEvents||i.unbindEntityEvents;this.stateEvents&&t(this,this,this.stateEvents)},computeStateProps:function(t,i){if(!this.finalMapStateToProps)return this.configureFinalMapState(t,i);var e=t.getState(),s=this.doStatePropsDependOnOwnProps?this.finalMapStateToProps(e,i):this.finalMapStateToProps(e);return s},configureFinalMapState:function(i,e){var s=this.mapState(i.getState(),e),n=t.isFunction(s);return this.finalMapStateToProps=n?s:this.mapState,this.doStatePropsDependOnOwnProps=1!==this.finalMapStateToProps.length,n?this.computeStateProps(i,e):s},updateStatePropsIfNeeded:function(){var i=this.computeStateProps(this.store,this.props);return(!this.stateProps||!t.isEqual(i,this.stateProps))&&(this.stateProps=i,!0)},computeDispatchProps:function(t,i){if(!this.finalMapDispatchToProps)return this.configureFinalMapDispatch(t,i);var e=t.dispatch,s=this.doDispatchPropsDependOnOwnProps?this.finalMapDispatchToProps(e,i):this.finalMapDispatchToProps(e);return s},configureFinalMapDispatch:function(i,e){var s=this.mapDispatch(i.dispatch,e),n=t.isFunction(s);return this.finalMapDispatchToProps=n?s:this.mapDispatch,this.doDispatchPropsDependOnOwnProps=1!==this.finalMapDispatchToProps.length,n?this.computeDispatchProps(i,e):s},updateDispatchPropsIfNeeded:function(){var i=this.computeDispatchProps(this.store,this.props);return(!this.dispatchProps||!t.isEqual(i,this.dispatchProps))&&(this.dispatchProps=i,!0)},isSubscribed:function(){return t.isFunction(this.unsubscribe)},trySubscribe:function(){this.isSubscribed()||(this.unsubscribe=this.store.subscribe(this.handleChange.bind(this)),this.handleDispatchProps(),this.handleChange())},tryUnsubscribe:function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)},onRender:function(){this.trySubscribe()},onDestroy:function(){this.tryUnsubscribe(),this.unbindStateEvents(),this.clearCache()},clearCache:function(){this.dispatchProps=null,this.stateProps=null,this.finalMapDispatchToProps=null,this.finalMapStateToProps=null,this.haveInitialStatePropsBeenDetermined=!1,this.haveInitialDispatchPropsBeenDetermined=!1},handleDispatchProps:function(){this.haveInitialDispatchPropsBeenDetermined||(this.updateDispatchPropsIfNeeded(),this.haveInitialDispatchPropsBeenDetermined=!0)},handleChange:function(){if(this.unsubscribe){var i=this.store.getState(),e=this.getState(\"storeState\");if(!this.haveInitialStatePropsBeenDetermined||!t.isEqual(e,i)){var s=this.updateStatePropsIfNeeded();if(this.haveInitialStatePropsBeenDetermined=!0,s){var n=this.mergeProps(this.stateProps,this.dispatchProps,this.props);this.props=n,t.isFunction(this.componentDidReceiveProps)&&this.componentDidReceiveProps(n)}this.setState({storeState:i})}}}},p=\"0.1.7\",h={connect:o,mixin:a,VERSION:p};return h});\n//# sourceMappingURL=marionette-redux.min.js.map\n"]}